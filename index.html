
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Pet Garden - ç­çº§å® ç‰©å›­</title>
    <!-- åŸºç¡€åº“ï¼šTailwind CSS å’Œ Babel ç¼–è¯‘å™¨ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #fff1f2;
            margin: 0;
            overflow: hidden;
        }
        /* å¯çˆ±çš„æ»šåŠ¨æ¡ */
        .cute-scrollbar::-webkit-scrollbar { width: 6px; }
        .cute-scrollbar::-webkit-scrollbar-track { background: #fff1f2; }
        .cute-scrollbar::-webkit-scrollbar-thumb { background: #fbcfe8; border-radius: 10px; }

        /* åŠ è½½ç•Œé¢å±‚ */
        #app-loader {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #fff1f2;
            z-index: 9999;
            transition: opacity 0.8s ease;
        }
        .loader-content {
            text-align: center;
        }
        .loader-pet {
            font-size: 70px;
            display: inline-block;
            animation: bounce 0.6s infinite alternate ease-in-out;
        }
        @keyframes bounce {
            from { transform: translateY(0) scale(1.1); }
            to { transform: translateY(-30px) scale(0.9); }
        }
        .loader-text {
            margin-top: 30px;
            color: #f472b6;
            font-weight: 800;
            font-size: 20px;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0px white;
        }
        
        /* å…¨å±€å¯çˆ±åŠ¨ç”» */
        @keyframes pet-float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(3deg); }
        }
        .pet-float-img { animation: pet-float 3s ease-in-out infinite; }
    </style>

    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom": "https://esm.sh/react-dom@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.474.0",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="app-loader">
        <div class="loader-content">
            <div class="loader-pet">ğŸ±</div>
            <p class="loader-text">é­”æ³•å® ç‰©å›­æ­£åœ¨å¼€å¯...</p>
        </div>
    </div>

    <div id="root"></div>

    <!-- 
        æ ¸å¿ƒä¿®å¤ï¼šGitHub Pages åŠ è½½å™¨ 
        åŸç†ï¼šæ‰‹åŠ¨ Fetch ä»£ç å†…å®¹ï¼Œç»•è¿‡æµè§ˆå™¨çš„ MIME ç±»å‹æ£€æŸ¥
    -->
    <script type="module">
        import React from 'react';
        import ReactDOM from 'react-dom/client';

        async function loadAndRun() {
            try {
                // 1. è·å–ä»£ç å†…å®¹ï¼ˆfetch ä¸å— MIME ç±»å‹é™åˆ¶ï¼‰
                const response = await fetch('./App.tsx');
                if (!response.ok) throw new Error('æ— æ³•è¯»å– App.tsx');
                const code = await response.text();

                // 2. ä½¿ç”¨ Babel æ‰‹åŠ¨ç¼–è¯‘
                const transformed = Babel.transform(code, {
                    presets: ['react', ['typescript', { isTSX: true, allExtensions: true }]],
                    filename: 'App.tsx',
                    // å…³é”®ï¼šå¤„ç† import è·¯å¾„ï¼Œè®©å®ƒä»¬æŒ‡å‘æ­£ç¡®çš„ URL
                    plugins: [
                        ({ types: t }) => ({
                            visitor: {
                                ImportDeclaration(path) {
                                    const source = path.node.source.value;
                                    // å¦‚æœæ˜¯æœ¬åœ°å¼•å…¥ä¸”æ²¡æœ‰åç¼€ï¼Œå°è¯•è¡¥å…¨åç¼€ï¼ˆé’ˆå¯¹ä½ çš„é¡¹ç›®ç»“æ„ï¼‰
                                    if (source.startsWith('./') || source.startsWith('../')) {
                                        // è¿™é‡Œç®€å•åŒ–å¤„ç†ï¼Œå‡å®šæ‰€æœ‰æœ¬åœ°å¼•å…¥éƒ½éœ€è¦ Babel å¤„ç†
                                        // å®é™…ä¸Šå¯¹äº GitHub Pagesï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ›´å¤æ‚çš„æ˜ å°„
                                    }
                                }
                            }
                        })
                    ]
                }).code;

                // 3. å°†ç¼–è¯‘åçš„ä»£ç è½¬ä¸º Blob URL å¹¶åŠ¨æ€å¯¼å…¥
                // æ³¨æ„ï¼šç”±äº App.tsx è¿˜æœ‰å¾ˆå¤šå­ä¾èµ–ï¼Œæœ€ç¨³å¦¥çš„æ–¹æ³•æ˜¯åœ¨è¿™é‡Œæ³¨å†Œä¸€ä¸ªç®€æ˜“çš„åŠ è½½å™¨æˆ–ç›´æ¥å°†ä¾èµ–ä¹Ÿå†…è”
                // ä½†å¯¹äºå½“å‰éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è®© Babel å¤„ç†æ•´ä¸ªå…¥å£
                
                // æ–¹æ¡ˆ Bï¼šç›´æ¥åœ¨è„šæœ¬å—ä¸­æ‰§è¡Œï¼ˆæœ€ç¨³å¦¥ï¼‰
                const script = document.createElement('script');
                script.type = 'text/babel';
                script.setAttribute('data-type', 'module');
                script.setAttribute('data-presets', 'react,typescript');
                script.innerHTML = code; 
                document.body.appendChild(script);

                // åªè¦ Babel è„šæœ¬å¼€å§‹è¿è¡Œï¼Œæˆ‘ä»¬å°±åœ¨ç¨åå…³é—­åŠ è½½å±‚
                setTimeout(() => {
                    const loader = document.getElementById('app-loader');
                    if (loader) {
                        loader.style.opacity = '0';
                        setTimeout(() => loader.remove(), 800);
                    }
                }, 2500);

            } catch (err) {
                console.error('åŠ è½½å¤±è´¥:', err);
                document.querySelector('.loader-text').innerHTML = 'âŒ é­”æ³•å’’è¯­å‡ºé”™äº†<br><small>' + err.message + '</small>';
            }
        }

        loadAndRun();
    </script>
</body>
</html>
